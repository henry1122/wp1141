{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport { GameState } from '../types/game';\nimport { createEmptyBoard, generateRandomBall, findAllMatches, applyGravity, removeBalls, calculateScore, isGameOver, canPlaceBall, getLowestEmptyRow, GAME_CONFIG } from '../utils/gameLogic';\nimport { useHighScore } from './useHighScore';\nimport { Difficulty } from '../types/levels';\nexport const useGameState = () => {\n  _s();\n  const {\n    checkAndUpdateHighScore,\n    highScore,\n    isNewHighScore\n  } = useHighScore();\n  const [gameState, setGameState] = useState(GameState.MENU);\n  const [currentDifficulty, setCurrentDifficulty] = useState(Difficulty.EASY);\n  const [board, setBoard] = useState(createEmptyBoard());\n  const [nextBall, setNextBall] = useState(null);\n  const [stats, setStats] = useState({\n    score: 0,\n    level: 1,\n    linesCleared: 0,\n    combo: 0,\n    timeElapsed: 0\n  });\n  const [levelComplete, setLevelComplete] = useState(false);\n  const gameLoopRef = useRef(null);\n  const dropTimerRef = useRef(null);\n  const timeTimerRef = useRef(null);\n\n  // 初始化下一個球\n  const initializeNextBall = useCallback(() => {\n    const ball = generateRandomBall({\n      row: 0,\n      col: 0\n    });\n    setNextBall(ball);\n  }, []);\n\n  // 隨機掉落球\n  const dropRandomBall = useCallback(() => {\n    setBoard(currentBoard => {\n      const availableColumns = [];\n      for (let col = 0; col < GAME_CONFIG.BOARD_WIDTH; col++) {\n        if (canPlaceBall(currentBoard, col)) {\n          availableColumns.push(col);\n        }\n      }\n      if (availableColumns.length === 0) {\n        setGameState(GameState.GAME_OVER);\n        return currentBoard;\n      }\n      const randomCol = availableColumns[Math.floor(Math.random() * availableColumns.length)];\n      const row = getLowestEmptyRow(currentBoard, randomCol);\n      if (row === -1) {\n        setGameState(GameState.GAME_OVER);\n        return currentBoard;\n      }\n      const ball = generateRandomBall({\n        row,\n        col: randomCol\n      });\n      const newBoard = [...currentBoard];\n      newBoard[row][randomCol] = ball;\n      return newBoard;\n    });\n  }, []);\n\n  // 處理連鎖反應\n  const processMatches = useCallback(currentBoard => {\n    let newBoard = [...currentBoard.map(row => [...row])];\n    let totalMatches = 0;\n    let comboCount = 0;\n    const processRound = () => {\n      const matches = findAllMatches(newBoard);\n      if (matches.length === 0) {\n        // 沒有更多匹配，結束連鎖\n        if (totalMatches > 0) {\n          const scoreGain = calculateScore(totalMatches, comboCount);\n          setStats(prev => ({\n            ...prev,\n            score: prev.score + scoreGain,\n            linesCleared: prev.linesCleared + Math.floor(totalMatches / GAME_CONFIG.MIN_MATCH_COUNT),\n            combo: comboCount,\n            level: Math.floor(prev.score / 1000) + 1\n          }));\n\n          // 重置連擊計數器\n          setTimeout(() => {\n            setStats(prev => ({\n              ...prev,\n              combo: 0\n            }));\n          }, 2000);\n        }\n        return;\n      }\n\n      // 移除匹配的球\n      newBoard = removeBalls(newBoard, matches);\n      totalMatches += matches.length;\n      comboCount++;\n\n      // 等待爆炸動畫完成後應用重力\n      setTimeout(() => {\n        // 實際移除球\n        matches.forEach(pos => {\n          newBoard[pos.row][pos.col] = null;\n        });\n\n        // 應用重力\n        newBoard = applyGravity(newBoard);\n        setBoard(newBoard);\n\n        // 繼續處理下一輪匹配\n        setTimeout(() => processRound(), 600);\n      }, 400);\n    };\n    processRound();\n  }, []);\n\n  // 開始遊戲\n  const startGame = useCallback(() => {\n    setGameState(GameState.PLAYING);\n    setBoard(createEmptyBoard());\n    setStats({\n      score: 0,\n      level: 1,\n      linesCleared: 0,\n      combo: 0,\n      timeElapsed: 0\n    });\n    initializeNextBall();\n\n    // 開始時間計時器\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    timeTimerRef.current = setInterval(() => {\n      setStats(prev => ({\n        ...prev,\n        timeElapsed: prev.timeElapsed + 1\n      }));\n    }, 1000);\n\n    // 開始自動掉落計時器\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    dropTimerRef.current = setInterval(() => {\n      dropRandomBall();\n    }, GAME_CONFIG.DROP_INTERVAL);\n  }, [initializeNextBall, dropRandomBall]);\n\n  // 暫停遊戲\n  const pauseGame = useCallback(() => {\n    setGameState(GameState.PAUSED);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n  }, []);\n\n  // 恢復遊戲\n  const resumeGame = useCallback(() => {\n    setGameState(GameState.PLAYING);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    timeTimerRef.current = setInterval(() => {\n      setStats(prev => ({\n        ...prev,\n        timeElapsed: prev.timeElapsed + 1\n      }));\n    }, 1000);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    dropTimerRef.current = setInterval(() => {\n      dropRandomBall();\n    }, GAME_CONFIG.DROP_INTERVAL);\n  }, [dropRandomBall]);\n\n  // 結束遊戲\n  const endGame = useCallback(() => {\n    setGameState(GameState.GAME_OVER);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n\n    // 檢查最高分\n    checkAndUpdateHighScore(stats.score, stats.level);\n  }, [checkAndUpdateHighScore, stats.score, stats.level]);\n\n  // 點擊格子放置球\n  const handleCellClick = useCallback((row, col) => {\n    if (gameState !== GameState.PLAYING || !nextBall) return;\n    const targetRow = getLowestEmptyRow(board, col);\n    if (targetRow === -1) return; // 該列已滿\n\n    // 放置球\n    const newBoard = [...board];\n    const ballToPlace = {\n      ...nextBall,\n      position: {\n        row: targetRow,\n        col\n      }\n    };\n    newBoard[targetRow][col] = ballToPlace;\n    setBoard(newBoard);\n\n    // 生成下一個球\n    initializeNextBall();\n\n    // 檢查匹配\n    setTimeout(() => {\n      processMatches(newBoard);\n    }, 100);\n\n    // 檢查遊戲結束\n    if (isGameOver(newBoard)) {\n      endGame();\n    }\n  }, [gameState, nextBall, board, processMatches, initializeNextBall, endGame]);\n\n  // 重置遊戲\n  const resetGame = useCallback(() => {\n    setGameState(GameState.MENU);\n    setBoard(createEmptyBoard());\n    setStats({\n      score: 0,\n      level: 1,\n      linesCleared: 0,\n      combo: 0,\n      timeElapsed: 0\n    });\n    setNextBall(null);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n  }, []);\n\n  // 清理計時器\n  useEffect(() => {\n    return () => {\n      if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n      if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    };\n  }, []);\n  return {\n    gameState,\n    board,\n    nextBall,\n    stats,\n    highScore,\n    isNewHighScore,\n    startGame,\n    pauseGame,\n    resumeGame,\n    resetGame,\n    handleCellClick\n  };\n};\n_s(useGameState, \"CVoSHuPznmlUnGlBANFERzobuJQ=\", false, function () {\n  return [useHighScore];\n});","map":{"version":3,"names":["useState","useCallback","useEffect","useRef","GameState","createEmptyBoard","generateRandomBall","findAllMatches","applyGravity","removeBalls","calculateScore","isGameOver","canPlaceBall","getLowestEmptyRow","GAME_CONFIG","useHighScore","Difficulty","useGameState","_s","checkAndUpdateHighScore","highScore","isNewHighScore","gameState","setGameState","MENU","currentDifficulty","setCurrentDifficulty","EASY","board","setBoard","nextBall","setNextBall","stats","setStats","score","level","linesCleared","combo","timeElapsed","levelComplete","setLevelComplete","gameLoopRef","dropTimerRef","timeTimerRef","initializeNextBall","ball","row","col","dropRandomBall","currentBoard","availableColumns","BOARD_WIDTH","push","length","GAME_OVER","randomCol","Math","floor","random","newBoard","processMatches","map","totalMatches","comboCount","processRound","matches","scoreGain","prev","MIN_MATCH_COUNT","setTimeout","forEach","pos","startGame","PLAYING","current","clearInterval","setInterval","DROP_INTERVAL","pauseGame","PAUSED","resumeGame","endGame","handleCellClick","targetRow","ballToPlace","position","resetGame"],"sources":["C:/Users/User/Desktop/wp1141/hw2/src/hooks/useGameState.ts"],"sourcesContent":["import { useState, useCallback, useEffect, useRef } from 'react';\r\nimport { \r\n  Ball, \r\n  GameState, \r\n  GameStats\r\n} from '../types/game';\r\nimport {\r\n  createEmptyBoard,\r\n  generateRandomBall,\r\n  findAllMatches,\r\n  applyGravity,\r\n  removeBalls,\r\n  calculateScore,\r\n  isGameOver,\r\n  canPlaceBall,\r\n  getLowestEmptyRow,\r\n  GAME_CONFIG\r\n} from '../utils/gameLogic';\r\nimport { useHighScore } from './useHighScore';\r\nimport { Difficulty, LEVEL_CONFIGS, getLevelByScore, getNextLevel } from '../types/levels';\r\n\r\nexport const useGameState = () => {\r\n  const { checkAndUpdateHighScore, highScore, isNewHighScore } = useHighScore();\r\n  const [gameState, setGameState] = useState<GameState>(GameState.MENU);\r\n  const [currentDifficulty, setCurrentDifficulty] = useState<Difficulty>(Difficulty.EASY);\r\n  const [board, setBoard] = useState<(Ball | null)[][]>(createEmptyBoard());\r\n  const [nextBall, setNextBall] = useState<Ball | null>(null);\r\n  const [stats, setStats] = useState<GameStats>({\r\n    score: 0,\r\n    level: 1,\r\n    linesCleared: 0,\r\n    combo: 0,\r\n    timeElapsed: 0\r\n  });\r\n  const [levelComplete, setLevelComplete] = useState(false);\r\n\r\n  const gameLoopRef = useRef<NodeJS.Timeout | null>(null);\r\n  const dropTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n  const timeTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // 初始化下一個球\r\n  const initializeNextBall = useCallback(() => {\r\n    const ball = generateRandomBall({ row: 0, col: 0 });\r\n    setNextBall(ball);\r\n  }, []);\r\n\r\n  // 隨機掉落球\r\n  const dropRandomBall = useCallback(() => {\r\n    setBoard(currentBoard => {\r\n      const availableColumns = [];\r\n      for (let col = 0; col < GAME_CONFIG.BOARD_WIDTH; col++) {\r\n        if (canPlaceBall(currentBoard, col)) {\r\n          availableColumns.push(col);\r\n        }\r\n      }\r\n\r\n      if (availableColumns.length === 0) {\r\n        setGameState(GameState.GAME_OVER);\r\n        return currentBoard;\r\n      }\r\n\r\n      const randomCol = availableColumns[Math.floor(Math.random() * availableColumns.length)];\r\n      const row = getLowestEmptyRow(currentBoard, randomCol);\r\n      \r\n      if (row === -1) {\r\n        setGameState(GameState.GAME_OVER);\r\n        return currentBoard;\r\n      }\r\n\r\n      const ball = generateRandomBall({ row, col: randomCol });\r\n      const newBoard = [...currentBoard];\r\n      newBoard[row][randomCol] = ball;\r\n\r\n      return newBoard;\r\n    });\r\n  }, []);\r\n\r\n  // 處理連鎖反應\r\n  const processMatches = useCallback((currentBoard: (Ball | null)[][]) => {\r\n    let newBoard = [...currentBoard.map(row => [...row])];\r\n    let totalMatches = 0;\r\n    let comboCount = 0;\r\n\r\n    const processRound = () => {\r\n      const matches = findAllMatches(newBoard);\r\n      \r\n      if (matches.length === 0) {\r\n        // 沒有更多匹配，結束連鎖\r\n        if (totalMatches > 0) {\r\n          const scoreGain = calculateScore(totalMatches, comboCount);\r\n          setStats(prev => ({\r\n            ...prev,\r\n            score: prev.score + scoreGain,\r\n            linesCleared: prev.linesCleared + Math.floor(totalMatches / GAME_CONFIG.MIN_MATCH_COUNT),\r\n            combo: comboCount,\r\n            level: Math.floor(prev.score / 1000) + 1\r\n          }));\r\n\r\n          // 重置連擊計數器\r\n          setTimeout(() => {\r\n            setStats(prev => ({ ...prev, combo: 0 }));\r\n          }, 2000);\r\n        }\r\n        return;\r\n      }\r\n\r\n      // 移除匹配的球\r\n      newBoard = removeBalls(newBoard, matches);\r\n      totalMatches += matches.length;\r\n      comboCount++;\r\n\r\n      // 等待爆炸動畫完成後應用重力\r\n      setTimeout(() => {\r\n        // 實際移除球\r\n        matches.forEach(pos => {\r\n          newBoard[pos.row][pos.col] = null;\r\n        });\r\n        \r\n        // 應用重力\r\n        newBoard = applyGravity(newBoard);\r\n        setBoard(newBoard);\r\n        \r\n        // 繼續處理下一輪匹配\r\n        setTimeout(() => processRound(), 600);\r\n      }, 400);\r\n    };\r\n\r\n    processRound();\r\n  }, []);\r\n\r\n  // 開始遊戲\r\n  const startGame = useCallback(() => {\r\n    setGameState(GameState.PLAYING);\r\n    setBoard(createEmptyBoard());\r\n    setStats({\r\n      score: 0,\r\n      level: 1,\r\n      linesCleared: 0,\r\n      combo: 0,\r\n      timeElapsed: 0\r\n    });\r\n    initializeNextBall();\r\n\r\n    // 開始時間計時器\r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n    timeTimerRef.current = setInterval(() => {\r\n      setStats(prev => ({ ...prev, timeElapsed: prev.timeElapsed + 1 }));\r\n    }, 1000);\r\n\r\n    // 開始自動掉落計時器\r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    dropTimerRef.current = setInterval(() => {\r\n      dropRandomBall();\r\n    }, GAME_CONFIG.DROP_INTERVAL);\r\n  }, [initializeNextBall, dropRandomBall]);\r\n\r\n  // 暫停遊戲\r\n  const pauseGame = useCallback(() => {\r\n    setGameState(GameState.PAUSED);\r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n  }, []);\r\n\r\n  // 恢復遊戲\r\n  const resumeGame = useCallback(() => {\r\n    setGameState(GameState.PLAYING);\r\n    \r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n    timeTimerRef.current = setInterval(() => {\r\n      setStats(prev => ({ ...prev, timeElapsed: prev.timeElapsed + 1 }));\r\n    }, 1000);\r\n\r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    dropTimerRef.current = setInterval(() => {\r\n      dropRandomBall();\r\n    }, GAME_CONFIG.DROP_INTERVAL);\r\n  }, [dropRandomBall]);\r\n\r\n  // 結束遊戲\r\n  const endGame = useCallback(() => {\r\n    setGameState(GameState.GAME_OVER);\r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\r\n    \r\n    // 檢查最高分\r\n    checkAndUpdateHighScore(stats.score, stats.level);\r\n  }, [checkAndUpdateHighScore, stats.score, stats.level]);\r\n\r\n  // 點擊格子放置球\r\n  const handleCellClick = useCallback((row: number, col: number) => {\r\n    if (gameState !== GameState.PLAYING || !nextBall) return;\r\n\r\n    const targetRow = getLowestEmptyRow(board, col);\r\n    if (targetRow === -1) return; // 該列已滿\r\n\r\n    // 放置球\r\n    const newBoard = [...board];\r\n    const ballToPlace = { ...nextBall, position: { row: targetRow, col } };\r\n    newBoard[targetRow][col] = ballToPlace;\r\n    \r\n    setBoard(newBoard);\r\n    \r\n    // 生成下一個球\r\n    initializeNextBall();\r\n    \r\n    // 檢查匹配\r\n    setTimeout(() => {\r\n      processMatches(newBoard);\r\n    }, 100);\r\n\r\n    // 檢查遊戲結束\r\n    if (isGameOver(newBoard)) {\r\n      endGame();\r\n    }\r\n  }, [gameState, nextBall, board, processMatches, initializeNextBall, endGame]);\r\n\r\n  // 重置遊戲\r\n  const resetGame = useCallback(() => {\r\n    setGameState(GameState.MENU);\r\n    setBoard(createEmptyBoard());\r\n    setStats({\r\n      score: 0,\r\n      level: 1,\r\n      linesCleared: 0,\r\n      combo: 0,\r\n      timeElapsed: 0\r\n    });\r\n    setNextBall(null);\r\n    \r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\r\n  }, []);\r\n\r\n  // 清理計時器\r\n  useEffect(() => {\r\n    return () => {\r\n      if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n      if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\r\n    };\r\n  }, []);\r\n\r\n  return {\r\n    gameState,\r\n    board,\r\n    nextBall,\r\n    stats,\r\n    highScore,\r\n    isNewHighScore,\r\n    startGame,\r\n    pauseGame,\r\n    resumeGame,\r\n    resetGame,\r\n    handleCellClick\r\n  };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}