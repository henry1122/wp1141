{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport { GameState } from '../types/game';\nimport { createEmptyBoard, generateRandomBall, findAllMatches, applyGravity, removeBalls, calculateScore, isGameOver, canPlaceBall, getLowestEmptyRow, GAME_CONFIG } from '../utils/gameLogic';\nimport { useHighScore } from './useHighScore';\nimport { Difficulty, LEVEL_CONFIGS, getNextLevel } from '../types/levels';\nexport const useGameState = () => {\n  _s();\n  const {\n    checkAndUpdateHighScore,\n    highScore,\n    isNewHighScore\n  } = useHighScore();\n  const [gameState, setGameState] = useState(GameState.MENU);\n  const [currentDifficulty, setCurrentDifficulty] = useState(Difficulty.EASY);\n  const [board, setBoard] = useState(createEmptyBoard());\n  const [nextBall, setNextBall] = useState(null);\n  const [stats, setStats] = useState({\n    score: 0,\n    level: 1,\n    linesCleared: 0,\n    combo: 0,\n    timeElapsed: 0\n  });\n  const [levelComplete, setLevelComplete] = useState(false);\n  const [timeRemaining, setTimeRemaining] = useState(0);\n  const gameLoopRef = useRef(null);\n  const dropTimerRef = useRef(null);\n  const timeTimerRef = useRef(null);\n  const countdownTimerRef = useRef(null);\n  const statsRef = useRef(stats);\n  const currentLevelConfig = LEVEL_CONFIGS[currentDifficulty];\n\n  // 保持 statsRef 最新，並且即時檢查最高分\n  useEffect(() => {\n    statsRef.current = stats;\n    // 當分數變化時，即時檢查最高分（但不觸發新紀錄通知）\n    if (stats.score > 0) {\n      checkAndUpdateHighScore(stats.score, stats.level);\n    }\n  }, [stats, checkAndUpdateHighScore]);\n\n  // 初始化下一個球\n  const initializeNextBall = useCallback(() => {\n    const ball = generateRandomBall({\n      row: 0,\n      col: 0\n    });\n    setNextBall(ball);\n  }, []);\n\n  // 隨機掉落球\n  const dropRandomBall = useCallback(() => {\n    setBoard(currentBoard => {\n      const availableColumns = [];\n      for (let col = 0; col < GAME_CONFIG.BOARD_WIDTH; col++) {\n        if (canPlaceBall(currentBoard, col)) {\n          availableColumns.push(col);\n        }\n      }\n      if (availableColumns.length === 0) {\n        setGameState(GameState.GAME_OVER);\n        return currentBoard;\n      }\n      const randomCol = availableColumns[Math.floor(Math.random() * availableColumns.length)];\n      const row = getLowestEmptyRow(currentBoard, randomCol);\n      if (row === -1) {\n        setGameState(GameState.GAME_OVER);\n        return currentBoard;\n      }\n      const ball = generateRandomBall({\n        row,\n        col: randomCol\n      });\n      const newBoard = [...currentBoard];\n      newBoard[row][randomCol] = ball;\n      return newBoard;\n    });\n  }, []);\n\n  // 處理連鎖反應\n  const processMatches = useCallback(currentBoard => {\n    let newBoard = [...currentBoard.map(row => [...row])];\n    let totalMatches = 0;\n    let comboCount = 0;\n    const processRound = () => {\n      const matches = findAllMatches(newBoard);\n      if (matches.length === 0) {\n        // 沒有更多匹配，結束連鎖\n        if (totalMatches > 0) {\n          const scoreGain = calculateScore(totalMatches, comboCount);\n          setStats(prev => {\n            const newScore = prev.score + scoreGain;\n            const newStats = {\n              ...prev,\n              score: newScore,\n              linesCleared: prev.linesCleared + Math.floor(totalMatches / currentLevelConfig.minMatchCount),\n              combo: comboCount,\n              level: Math.floor(newScore / 1000) + 1\n            };\n\n            // 檢查是否完成當前關卡\n            if (newScore >= currentLevelConfig.targetScore && !levelComplete) {\n              console.log('Level complete!', {\n                newScore,\n                target: currentLevelConfig.targetScore,\n                levelComplete\n              });\n              setTimeout(() => {\n                setLevelComplete(true);\n                // 暫停遊戲並顯示勝利頁面\n                setGameState(GameState.PAUSED);\n                if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n                if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n                if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n              }, 1000);\n            }\n            return newStats;\n          });\n\n          // 重置連擊計數器\n          setTimeout(() => {\n            setStats(prev => ({\n              ...prev,\n              combo: 0\n            }));\n          }, 2000);\n        }\n        return;\n      }\n\n      // 移除匹配的球\n      newBoard = removeBalls(newBoard, matches);\n      totalMatches += matches.length;\n      comboCount++;\n\n      // 等待爆炸動畫完成後應用重力\n      setTimeout(() => {\n        // 實際移除球\n        matches.forEach(pos => {\n          newBoard[pos.row][pos.col] = null;\n        });\n\n        // 應用重力\n        newBoard = applyGravity(newBoard);\n        setBoard(newBoard);\n\n        // 繼續處理下一輪匹配\n        setTimeout(() => processRound(), 600);\n      }, 400);\n    };\n    processRound();\n  }, [currentLevelConfig.minMatchCount, currentLevelConfig.targetScore, levelComplete]);\n\n  // 開始遊戲\n  const startGame = useCallback(difficulty => {\n    if (difficulty) {\n      setCurrentDifficulty(difficulty);\n    }\n    setGameState(GameState.PLAYING);\n    setBoard(createEmptyBoard());\n    setStats({\n      score: 0,\n      level: 1,\n      linesCleared: 0,\n      combo: 0,\n      timeElapsed: 0\n    });\n    setLevelComplete(false);\n    initializeNextBall();\n    const levelConfig = difficulty ? LEVEL_CONFIGS[difficulty] : currentLevelConfig;\n    setTimeRemaining(levelConfig.timeLimit);\n\n    // 開始時間計時器\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    timeTimerRef.current = setInterval(() => {\n      setStats(prev => ({\n        ...prev,\n        timeElapsed: prev.timeElapsed + 1\n      }));\n    }, 1000);\n\n    // 開始倒數計時器\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n    countdownTimerRef.current = setInterval(() => {\n      setTimeRemaining(prev => {\n        if (prev <= 1) {\n          // 時間到了，遊戲結束\n          setGameState(GameState.GAME_OVER);\n          // 清理所有計時器\n          if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n          if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n          if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n          // 檢查最高分 - 使用最新的 stats\n          checkAndUpdateHighScore(statsRef.current.score, statsRef.current.level);\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    // 開始自動掉落計時器\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    dropTimerRef.current = setInterval(() => {\n      dropRandomBall();\n    }, levelConfig.dropInterval);\n  }, [initializeNextBall, dropRandomBall, currentLevelConfig]);\n\n  // 暫停遊戲\n  const pauseGame = useCallback(() => {\n    setGameState(GameState.PAUSED);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n  }, []);\n\n  // 恢復遊戲\n  const resumeGame = useCallback(() => {\n    setGameState(GameState.PLAYING);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    timeTimerRef.current = setInterval(() => {\n      setStats(prev => ({\n        ...prev,\n        timeElapsed: prev.timeElapsed + 1\n      }));\n    }, 1000);\n\n    // 恢復倒數計時器\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n    countdownTimerRef.current = setInterval(() => {\n      setTimeRemaining(prev => {\n        if (prev <= 1) {\n          setGameState(GameState.GAME_OVER);\n          // 清理所有計時器\n          if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n          if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n          if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n          // 檢查最高分 - 使用最新的 stats\n          checkAndUpdateHighScore(statsRef.current.score, statsRef.current.level);\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    dropTimerRef.current = setInterval(() => {\n      dropRandomBall();\n    }, currentLevelConfig.dropInterval);\n  }, [dropRandomBall, currentLevelConfig.dropInterval]);\n\n  // 結束遊戲\n  const endGame = useCallback(() => {\n    setGameState(GameState.GAME_OVER);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n\n    // 檢查最高分 - 使用最新的 stats\n    checkAndUpdateHighScore(statsRef.current.score, statsRef.current.level);\n  }, [checkAndUpdateHighScore]);\n\n  // 點擊格子放置球\n  const handleCellClick = useCallback((row, col) => {\n    if (gameState !== GameState.PLAYING || !nextBall) return;\n    const targetRow = getLowestEmptyRow(board, col);\n    if (targetRow === -1) return; // 該列已滿\n\n    // 放置球\n    const newBoard = [...board];\n    const ballToPlace = {\n      ...nextBall,\n      position: {\n        row: targetRow,\n        col\n      }\n    };\n    newBoard[targetRow][col] = ballToPlace;\n    setBoard(newBoard);\n\n    // 生成下一個球\n    initializeNextBall();\n\n    // 檢查匹配\n    setTimeout(() => {\n      processMatches(newBoard);\n    }, 100);\n\n    // 檢查遊戲結束\n    if (isGameOver(newBoard)) {\n      endGame();\n    }\n  }, [gameState, nextBall, board, processMatches, initializeNextBall, endGame]);\n\n  // 重置遊戲\n  const resetGame = useCallback(() => {\n    setGameState(GameState.MENU);\n    setBoard(createEmptyBoard());\n    setStats({\n      score: 0,\n      level: 1,\n      linesCleared: 0,\n      combo: 0,\n      timeElapsed: 0\n    });\n    setNextBall(null);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n  }, []);\n\n  // 清理計時器\n  useEffect(() => {\n    return () => {\n      if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n      if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n      if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    };\n  }, []);\n\n  // 進入下一關\n  const nextLevelHandler = useCallback(() => {\n    const next = getNextLevel(currentDifficulty);\n    if (next) {\n      setLevelComplete(false);\n      setCurrentDifficulty(next.id);\n      // 使用 setTimeout 確保狀態更新後再開始遊戲\n      setTimeout(() => {\n        startGame(next.id);\n      }, 100);\n    }\n  }, [currentDifficulty, startGame]);\n\n  // 設置難度\n  const setDifficultyHandler = useCallback(difficulty => {\n    setCurrentDifficulty(difficulty);\n  }, []);\n\n  // 重置關卡完成狀態\n  const resetLevelComplete = useCallback(() => {\n    setLevelComplete(false);\n  }, []);\n  return {\n    gameState,\n    board,\n    nextBall,\n    stats,\n    highScore,\n    isNewHighScore,\n    currentDifficulty,\n    currentLevelConfig,\n    levelComplete,\n    timeRemaining,\n    startGame,\n    pauseGame,\n    resumeGame,\n    resetGame,\n    nextLevel: nextLevelHandler,\n    setDifficulty: setDifficultyHandler,\n    resetLevelComplete,\n    handleCellClick\n  };\n};\n_s(useGameState, \"qbqcINZXlNOfw7U4fvygzpxo3dU=\", false, function () {\n  return [useHighScore];\n});","map":{"version":3,"names":["useState","useCallback","useEffect","useRef","GameState","createEmptyBoard","generateRandomBall","findAllMatches","applyGravity","removeBalls","calculateScore","isGameOver","canPlaceBall","getLowestEmptyRow","GAME_CONFIG","useHighScore","Difficulty","LEVEL_CONFIGS","getNextLevel","useGameState","_s","checkAndUpdateHighScore","highScore","isNewHighScore","gameState","setGameState","MENU","currentDifficulty","setCurrentDifficulty","EASY","board","setBoard","nextBall","setNextBall","stats","setStats","score","level","linesCleared","combo","timeElapsed","levelComplete","setLevelComplete","timeRemaining","setTimeRemaining","gameLoopRef","dropTimerRef","timeTimerRef","countdownTimerRef","statsRef","currentLevelConfig","current","initializeNextBall","ball","row","col","dropRandomBall","currentBoard","availableColumns","BOARD_WIDTH","push","length","GAME_OVER","randomCol","Math","floor","random","newBoard","processMatches","map","totalMatches","comboCount","processRound","matches","scoreGain","prev","newScore","newStats","minMatchCount","targetScore","console","log","target","setTimeout","PAUSED","clearInterval","forEach","pos","startGame","difficulty","PLAYING","levelConfig","timeLimit","setInterval","dropInterval","pauseGame","resumeGame","endGame","handleCellClick","targetRow","ballToPlace","position","resetGame","nextLevelHandler","next","id","setDifficultyHandler","resetLevelComplete","nextLevel","setDifficulty"],"sources":["C:/Users/User/Desktop/wp1141/hw2/src/hooks/useGameState.ts"],"sourcesContent":["import { useState, useCallback, useEffect, useRef } from 'react';\nimport { \n  Ball, \n  GameState, \n  GameStats\n} from '../types/game';\nimport {\n  createEmptyBoard,\n  generateRandomBall,\n  findAllMatches,\n  applyGravity,\n  removeBalls,\n  calculateScore,\n  isGameOver,\n  canPlaceBall,\n  getLowestEmptyRow,\n  GAME_CONFIG\n} from '../utils/gameLogic';\nimport { useHighScore } from './useHighScore';\nimport { Difficulty, LEVEL_CONFIGS, getNextLevel } from '../types/levels';\n\nexport const useGameState = () => {\n  const { checkAndUpdateHighScore, highScore, isNewHighScore } = useHighScore();\n  const [gameState, setGameState] = useState<GameState>(GameState.MENU);\n  const [currentDifficulty, setCurrentDifficulty] = useState<Difficulty>(Difficulty.EASY);\n  const [board, setBoard] = useState<(Ball | null)[][]>(createEmptyBoard());\n  const [nextBall, setNextBall] = useState<Ball | null>(null);\n  const [stats, setStats] = useState<GameStats>({\n    score: 0,\n    level: 1,\n    linesCleared: 0,\n    combo: 0,\n    timeElapsed: 0\n  });\n  const [levelComplete, setLevelComplete] = useState(false);\n  const [timeRemaining, setTimeRemaining] = useState(0);\n\n  const gameLoopRef = useRef<NodeJS.Timeout | null>(null);\n  const dropTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const timeTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const countdownTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const statsRef = useRef(stats);\n  const currentLevelConfig = LEVEL_CONFIGS[currentDifficulty];\n\n  // 保持 statsRef 最新，並且即時檢查最高分\n  useEffect(() => {\n    statsRef.current = stats;\n    // 當分數變化時，即時檢查最高分（但不觸發新紀錄通知）\n    if (stats.score > 0) {\n      checkAndUpdateHighScore(stats.score, stats.level);\n    }\n  }, [stats, checkAndUpdateHighScore]);\n\n  // 初始化下一個球\n  const initializeNextBall = useCallback(() => {\n    const ball = generateRandomBall({ row: 0, col: 0 });\n    setNextBall(ball);\n  }, []);\n\n  // 隨機掉落球\n  const dropRandomBall = useCallback(() => {\n    setBoard(currentBoard => {\n      const availableColumns = [];\n      for (let col = 0; col < GAME_CONFIG.BOARD_WIDTH; col++) {\n        if (canPlaceBall(currentBoard, col)) {\n          availableColumns.push(col);\n        }\n      }\n\n      if (availableColumns.length === 0) {\n        setGameState(GameState.GAME_OVER);\n        return currentBoard;\n      }\n\n      const randomCol = availableColumns[Math.floor(Math.random() * availableColumns.length)];\n      const row = getLowestEmptyRow(currentBoard, randomCol);\n      \n      if (row === -1) {\n        setGameState(GameState.GAME_OVER);\n        return currentBoard;\n      }\n\n      const ball = generateRandomBall({ row, col: randomCol });\n      const newBoard = [...currentBoard];\n      newBoard[row][randomCol] = ball;\n\n      return newBoard;\n    });\n  }, []);\n\n  // 處理連鎖反應\n  const processMatches = useCallback((currentBoard: (Ball | null)[][]) => {\n    let newBoard = [...currentBoard.map(row => [...row])];\n    let totalMatches = 0;\n    let comboCount = 0;\n\n    const processRound = () => {\n      const matches = findAllMatches(newBoard);\n      \n      if (matches.length === 0) {\n        // 沒有更多匹配，結束連鎖\n        if (totalMatches > 0) {\n          const scoreGain = calculateScore(totalMatches, comboCount);\n          setStats(prev => {\n            const newScore = prev.score + scoreGain;\n            const newStats = {\n              ...prev,\n              score: newScore,\n              linesCleared: prev.linesCleared + Math.floor(totalMatches / currentLevelConfig.minMatchCount),\n              combo: comboCount,\n              level: Math.floor(newScore / 1000) + 1\n            };\n            \n            // 檢查是否完成當前關卡\n            if (newScore >= currentLevelConfig.targetScore && !levelComplete) {\n              console.log('Level complete!', { newScore, target: currentLevelConfig.targetScore, levelComplete });\n              setTimeout(() => {\n                setLevelComplete(true);\n                // 暫停遊戲並顯示勝利頁面\n                setGameState(GameState.PAUSED);\n                if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n                if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n                if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n              }, 1000);\n            }\n            \n            return newStats;\n          });\n\n          // 重置連擊計數器\n          setTimeout(() => {\n            setStats(prev => ({ ...prev, combo: 0 }));\n          }, 2000);\n        }\n        return;\n      }\n\n      // 移除匹配的球\n      newBoard = removeBalls(newBoard, matches);\n      totalMatches += matches.length;\n      comboCount++;\n\n      // 等待爆炸動畫完成後應用重力\n      setTimeout(() => {\n        // 實際移除球\n        matches.forEach(pos => {\n          newBoard[pos.row][pos.col] = null;\n        });\n        \n        // 應用重力\n        newBoard = applyGravity(newBoard);\n        setBoard(newBoard);\n        \n        // 繼續處理下一輪匹配\n        setTimeout(() => processRound(), 600);\n      }, 400);\n    };\n\n    processRound();\n  }, [currentLevelConfig.minMatchCount, currentLevelConfig.targetScore, levelComplete]);\n\n  // 開始遊戲\n  const startGame = useCallback((difficulty?: Difficulty) => {\n    if (difficulty) {\n      setCurrentDifficulty(difficulty);\n    }\n    setGameState(GameState.PLAYING);\n    setBoard(createEmptyBoard());\n    setStats({\n      score: 0,\n      level: 1,\n      linesCleared: 0,\n      combo: 0,\n      timeElapsed: 0\n    });\n    setLevelComplete(false);\n    initializeNextBall();\n\n    const levelConfig = difficulty ? LEVEL_CONFIGS[difficulty] : currentLevelConfig;\n    setTimeRemaining(levelConfig.timeLimit);\n\n    // 開始時間計時器\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    timeTimerRef.current = setInterval(() => {\n      setStats(prev => ({ ...prev, timeElapsed: prev.timeElapsed + 1 }));\n    }, 1000);\n\n    // 開始倒數計時器\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n    countdownTimerRef.current = setInterval(() => {\n      setTimeRemaining(prev => {\n        if (prev <= 1) {\n          // 時間到了，遊戲結束\n          setGameState(GameState.GAME_OVER);\n          // 清理所有計時器\n          if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n          if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n          if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n          // 檢查最高分 - 使用最新的 stats\n          checkAndUpdateHighScore(statsRef.current.score, statsRef.current.level);\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    // 開始自動掉落計時器\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    dropTimerRef.current = setInterval(() => {\n      dropRandomBall();\n    }, levelConfig.dropInterval);\n  }, [initializeNextBall, dropRandomBall, currentLevelConfig]);\n\n  // 暫停遊戲\n  const pauseGame = useCallback(() => {\n    setGameState(GameState.PAUSED);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n  }, []);\n\n  // 恢復遊戲\n  const resumeGame = useCallback(() => {\n    setGameState(GameState.PLAYING);\n    \n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    timeTimerRef.current = setInterval(() => {\n      setStats(prev => ({ ...prev, timeElapsed: prev.timeElapsed + 1 }));\n    }, 1000);\n\n    // 恢復倒數計時器\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n    countdownTimerRef.current = setInterval(() => {\n      setTimeRemaining(prev => {\n        if (prev <= 1) {\n          setGameState(GameState.GAME_OVER);\n          // 清理所有計時器\n          if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n          if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n          if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n          // 檢查最高分 - 使用最新的 stats\n          checkAndUpdateHighScore(statsRef.current.score, statsRef.current.level);\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    dropTimerRef.current = setInterval(() => {\n      dropRandomBall();\n    }, currentLevelConfig.dropInterval);\n  }, [dropRandomBall, currentLevelConfig.dropInterval]);\n\n  // 結束遊戲\n  const endGame = useCallback(() => {\n    setGameState(GameState.GAME_OVER);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    \n    // 檢查最高分 - 使用最新的 stats\n    checkAndUpdateHighScore(statsRef.current.score, statsRef.current.level);\n  }, [checkAndUpdateHighScore]);\n\n  // 點擊格子放置球\n  const handleCellClick = useCallback((row: number, col: number) => {\n    if (gameState !== GameState.PLAYING || !nextBall) return;\n\n    const targetRow = getLowestEmptyRow(board, col);\n    if (targetRow === -1) return; // 該列已滿\n\n    // 放置球\n    const newBoard = [...board];\n    const ballToPlace = { ...nextBall, position: { row: targetRow, col } };\n    newBoard[targetRow][col] = ballToPlace;\n    \n    setBoard(newBoard);\n    \n    // 生成下一個球\n    initializeNextBall();\n    \n    // 檢查匹配\n    setTimeout(() => {\n      processMatches(newBoard);\n    }, 100);\n\n    // 檢查遊戲結束\n    if (isGameOver(newBoard)) {\n      endGame();\n    }\n  }, [gameState, nextBall, board, processMatches, initializeNextBall, endGame]);\n\n  // 重置遊戲\n  const resetGame = useCallback(() => {\n    setGameState(GameState.MENU);\n    setBoard(createEmptyBoard());\n    setStats({\n      score: 0,\n      level: 1,\n      linesCleared: 0,\n      combo: 0,\n      timeElapsed: 0\n    });\n    setNextBall(null);\n    \n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n  }, []);\n\n  // 清理計時器\n  useEffect(() => {\n    return () => {\n      if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n      if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n      if (countdownTimerRef.current) clearInterval(countdownTimerRef.current);\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    };\n  }, []);\n\n  // 進入下一關\n  const nextLevelHandler = useCallback(() => {\n    const next = getNextLevel(currentDifficulty);\n    if (next) {\n      setLevelComplete(false);\n      setCurrentDifficulty(next.id);\n      // 使用 setTimeout 確保狀態更新後再開始遊戲\n      setTimeout(() => {\n        startGame(next.id);\n      }, 100);\n    }\n  }, [currentDifficulty, startGame]);\n\n  // 設置難度\n  const setDifficultyHandler = useCallback((difficulty: Difficulty) => {\n    setCurrentDifficulty(difficulty);\n  }, []);\n\n  // 重置關卡完成狀態\n  const resetLevelComplete = useCallback(() => {\n    setLevelComplete(false);\n  }, []);\n\n  return {\n    gameState,\n    board,\n    nextBall,\n    stats,\n    highScore,\n    isNewHighScore,\n    currentDifficulty,\n    currentLevelConfig,\n    levelComplete,\n    timeRemaining,\n    startGame,\n    pauseGame,\n    resumeGame,\n    resetGame,\n    nextLevel: nextLevelHandler,\n    setDifficulty: setDifficultyHandler,\n    resetLevelComplete,\n    handleCellClick\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}