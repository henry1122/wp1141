{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport { GameState } from '../types/game';\nimport { createEmptyBoard, generateRandomBall, findAllMatches, applyGravity, removeBalls, calculateScore, isGameOver, canPlaceBall, getLowestEmptyRow, GAME_CONFIG } from '../utils/gameLogic';\nimport { useHighScore } from './useHighScore';\nimport { Difficulty, LEVEL_CONFIGS, getNextLevel } from '../types/levels';\nexport const useGameState = () => {\n  _s();\n  const {\n    checkAndUpdateHighScore,\n    highScore,\n    isNewHighScore\n  } = useHighScore();\n  const [gameState, setGameState] = useState(GameState.MENU);\n  const [currentDifficulty, setCurrentDifficulty] = useState(Difficulty.EASY);\n  const [board, setBoard] = useState(createEmptyBoard());\n  const [nextBall, setNextBall] = useState(null);\n  const [stats, setStats] = useState({\n    score: 0,\n    level: 1,\n    linesCleared: 0,\n    combo: 0,\n    timeElapsed: 0\n  });\n  const [levelComplete, setLevelComplete] = useState(false);\n  const gameLoopRef = useRef(null);\n  const dropTimerRef = useRef(null);\n  const timeTimerRef = useRef(null);\n  const currentLevelConfig = LEVEL_CONFIGS[currentDifficulty];\n\n  // 初始化下一個球\n  const initializeNextBall = useCallback(() => {\n    const ball = generateRandomBall({\n      row: 0,\n      col: 0\n    });\n    setNextBall(ball);\n  }, []);\n\n  // 隨機掉落球\n  const dropRandomBall = useCallback(() => {\n    setBoard(currentBoard => {\n      const availableColumns = [];\n      for (let col = 0; col < GAME_CONFIG.BOARD_WIDTH; col++) {\n        if (canPlaceBall(currentBoard, col)) {\n          availableColumns.push(col);\n        }\n      }\n      if (availableColumns.length === 0) {\n        setGameState(GameState.GAME_OVER);\n        return currentBoard;\n      }\n      const randomCol = availableColumns[Math.floor(Math.random() * availableColumns.length)];\n      const row = getLowestEmptyRow(currentBoard, randomCol);\n      if (row === -1) {\n        setGameState(GameState.GAME_OVER);\n        return currentBoard;\n      }\n      const ball = generateRandomBall({\n        row,\n        col: randomCol\n      });\n      const newBoard = [...currentBoard];\n      newBoard[row][randomCol] = ball;\n      return newBoard;\n    });\n  }, []);\n\n  // 處理連鎖反應\n  const processMatches = useCallback(currentBoard => {\n    let newBoard = [...currentBoard.map(row => [...row])];\n    let totalMatches = 0;\n    let comboCount = 0;\n    const processRound = () => {\n      const matches = findAllMatches(newBoard);\n      if (matches.length === 0) {\n        // 沒有更多匹配，結束連鎖\n        if (totalMatches > 0) {\n          const scoreGain = calculateScore(totalMatches, comboCount);\n          setStats(prev => {\n            const newScore = prev.score + scoreGain;\n            const newStats = {\n              ...prev,\n              score: newScore,\n              linesCleared: prev.linesCleared + Math.floor(totalMatches / currentLevelConfig.minMatchCount),\n              combo: comboCount,\n              level: Math.floor(newScore / 1000) + 1\n            };\n\n            // 檢查是否完成當前關卡\n            if (newScore >= currentLevelConfig.targetScore && !levelComplete) {\n              setTimeout(() => setLevelComplete(true), 1000);\n            }\n            return newStats;\n          });\n\n          // 重置連擊計數器\n          setTimeout(() => {\n            setStats(prev => ({\n              ...prev,\n              combo: 0\n            }));\n          }, 2000);\n        }\n        return;\n      }\n\n      // 移除匹配的球\n      newBoard = removeBalls(newBoard, matches);\n      totalMatches += matches.length;\n      comboCount++;\n\n      // 等待爆炸動畫完成後應用重力\n      setTimeout(() => {\n        // 實際移除球\n        matches.forEach(pos => {\n          newBoard[pos.row][pos.col] = null;\n        });\n\n        // 應用重力\n        newBoard = applyGravity(newBoard);\n        setBoard(newBoard);\n\n        // 繼續處理下一輪匹配\n        setTimeout(() => processRound(), 600);\n      }, 400);\n    };\n    processRound();\n  }, [currentLevelConfig.minMatchCount, currentLevelConfig.targetScore, levelComplete]);\n\n  // 開始遊戲\n  const startGame = useCallback(difficulty => {\n    if (difficulty) {\n      setCurrentDifficulty(difficulty);\n    }\n    setGameState(GameState.PLAYING);\n    setBoard(createEmptyBoard());\n    setStats({\n      score: 0,\n      level: 1,\n      linesCleared: 0,\n      combo: 0,\n      timeElapsed: 0\n    });\n    setLevelComplete(false);\n    initializeNextBall();\n\n    // 開始時間計時器\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    timeTimerRef.current = setInterval(() => {\n      setStats(prev => ({\n        ...prev,\n        timeElapsed: prev.timeElapsed + 1\n      }));\n    }, 1000);\n    const levelConfig = difficulty ? LEVEL_CONFIGS[difficulty] : currentLevelConfig;\n\n    // 開始自動掉落計時器\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    dropTimerRef.current = setInterval(() => {\n      dropRandomBall();\n    }, levelConfig.dropInterval);\n  }, [initializeNextBall, dropRandomBall, currentLevelConfig]);\n\n  // 暫停遊戲\n  const pauseGame = useCallback(() => {\n    setGameState(GameState.PAUSED);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n  }, []);\n\n  // 恢復遊戲\n  const resumeGame = useCallback(() => {\n    setGameState(GameState.PLAYING);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    timeTimerRef.current = setInterval(() => {\n      setStats(prev => ({\n        ...prev,\n        timeElapsed: prev.timeElapsed + 1\n      }));\n    }, 1000);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    dropTimerRef.current = setInterval(() => {\n      dropRandomBall();\n    }, GAME_CONFIG.DROP_INTERVAL);\n  }, [dropRandomBall]);\n\n  // 結束遊戲\n  const endGame = useCallback(() => {\n    setGameState(GameState.GAME_OVER);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n\n    // 檢查最高分\n    checkAndUpdateHighScore(stats.score, stats.level);\n  }, [checkAndUpdateHighScore, stats.score, stats.level]);\n\n  // 點擊格子放置球\n  const handleCellClick = useCallback((row, col) => {\n    if (gameState !== GameState.PLAYING || !nextBall) return;\n    const targetRow = getLowestEmptyRow(board, col);\n    if (targetRow === -1) return; // 該列已滿\n\n    // 放置球\n    const newBoard = [...board];\n    const ballToPlace = {\n      ...nextBall,\n      position: {\n        row: targetRow,\n        col\n      }\n    };\n    newBoard[targetRow][col] = ballToPlace;\n    setBoard(newBoard);\n\n    // 生成下一個球\n    initializeNextBall();\n\n    // 檢查匹配\n    setTimeout(() => {\n      processMatches(newBoard);\n    }, 100);\n\n    // 檢查遊戲結束\n    if (isGameOver(newBoard)) {\n      endGame();\n    }\n  }, [gameState, nextBall, board, processMatches, initializeNextBall, endGame]);\n\n  // 重置遊戲\n  const resetGame = useCallback(() => {\n    setGameState(GameState.MENU);\n    setBoard(createEmptyBoard());\n    setStats({\n      score: 0,\n      level: 1,\n      linesCleared: 0,\n      combo: 0,\n      timeElapsed: 0\n    });\n    setNextBall(null);\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n  }, []);\n\n  // 清理計時器\n  useEffect(() => {\n    return () => {\n      if (dropTimerRef.current) clearInterval(dropTimerRef.current);\n      if (timeTimerRef.current) clearInterval(timeTimerRef.current);\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    };\n  }, []);\n\n  // 進入下一關\n  const nextLevelHandler = useCallback(() => {\n    const next = getNextLevel(currentDifficulty);\n    if (next) {\n      setCurrentDifficulty(next.id);\n      startGame(next.id);\n      setLevelComplete(false);\n    }\n  }, [currentDifficulty, startGame]);\n\n  // 設置難度\n  const setDifficultyHandler = useCallback(difficulty => {\n    setCurrentDifficulty(difficulty);\n  }, []);\n  return {\n    gameState,\n    board,\n    nextBall,\n    stats,\n    highScore,\n    isNewHighScore,\n    currentDifficulty,\n    currentLevelConfig,\n    levelComplete,\n    startGame,\n    pauseGame,\n    resumeGame,\n    resetGame,\n    nextLevel: nextLevelHandler,\n    setDifficulty: setDifficultyHandler,\n    handleCellClick\n  };\n};\n_s(useGameState, \"V7CGhVALNIlMSqZiSoeiZ0CSec4=\", false, function () {\n  return [useHighScore];\n});","map":{"version":3,"names":["useState","useCallback","useEffect","useRef","GameState","createEmptyBoard","generateRandomBall","findAllMatches","applyGravity","removeBalls","calculateScore","isGameOver","canPlaceBall","getLowestEmptyRow","GAME_CONFIG","useHighScore","Difficulty","LEVEL_CONFIGS","getNextLevel","useGameState","_s","checkAndUpdateHighScore","highScore","isNewHighScore","gameState","setGameState","MENU","currentDifficulty","setCurrentDifficulty","EASY","board","setBoard","nextBall","setNextBall","stats","setStats","score","level","linesCleared","combo","timeElapsed","levelComplete","setLevelComplete","gameLoopRef","dropTimerRef","timeTimerRef","currentLevelConfig","initializeNextBall","ball","row","col","dropRandomBall","currentBoard","availableColumns","BOARD_WIDTH","push","length","GAME_OVER","randomCol","Math","floor","random","newBoard","processMatches","map","totalMatches","comboCount","processRound","matches","scoreGain","prev","newScore","newStats","minMatchCount","targetScore","setTimeout","forEach","pos","startGame","difficulty","PLAYING","current","clearInterval","setInterval","levelConfig","dropInterval","pauseGame","PAUSED","resumeGame","DROP_INTERVAL","endGame","handleCellClick","targetRow","ballToPlace","position","resetGame","nextLevelHandler","next","id","setDifficultyHandler","nextLevel","setDifficulty"],"sources":["C:/Users/User/Desktop/wp1141/hw2/src/hooks/useGameState.ts"],"sourcesContent":["import { useState, useCallback, useEffect, useRef } from 'react';\r\nimport { \r\n  Ball, \r\n  GameState, \r\n  GameStats\r\n} from '../types/game';\r\nimport {\r\n  createEmptyBoard,\r\n  generateRandomBall,\r\n  findAllMatches,\r\n  applyGravity,\r\n  removeBalls,\r\n  calculateScore,\r\n  isGameOver,\r\n  canPlaceBall,\r\n  getLowestEmptyRow,\r\n  GAME_CONFIG\r\n} from '../utils/gameLogic';\r\nimport { useHighScore } from './useHighScore';\r\nimport { Difficulty, LEVEL_CONFIGS, getNextLevel } from '../types/levels';\r\n\r\nexport const useGameState = () => {\r\n  const { checkAndUpdateHighScore, highScore, isNewHighScore } = useHighScore();\r\n  const [gameState, setGameState] = useState<GameState>(GameState.MENU);\r\n  const [currentDifficulty, setCurrentDifficulty] = useState<Difficulty>(Difficulty.EASY);\r\n  const [board, setBoard] = useState<(Ball | null)[][]>(createEmptyBoard());\r\n  const [nextBall, setNextBall] = useState<Ball | null>(null);\r\n  const [stats, setStats] = useState<GameStats>({\r\n    score: 0,\r\n    level: 1,\r\n    linesCleared: 0,\r\n    combo: 0,\r\n    timeElapsed: 0\r\n  });\r\n  const [levelComplete, setLevelComplete] = useState(false);\r\n\r\n  const gameLoopRef = useRef<NodeJS.Timeout | null>(null);\r\n  const dropTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n  const timeTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n  const currentLevelConfig = LEVEL_CONFIGS[currentDifficulty];\r\n\r\n  // 初始化下一個球\r\n  const initializeNextBall = useCallback(() => {\r\n    const ball = generateRandomBall({ row: 0, col: 0 });\r\n    setNextBall(ball);\r\n  }, []);\r\n\r\n  // 隨機掉落球\r\n  const dropRandomBall = useCallback(() => {\r\n    setBoard(currentBoard => {\r\n      const availableColumns = [];\r\n      for (let col = 0; col < GAME_CONFIG.BOARD_WIDTH; col++) {\r\n        if (canPlaceBall(currentBoard, col)) {\r\n          availableColumns.push(col);\r\n        }\r\n      }\r\n\r\n      if (availableColumns.length === 0) {\r\n        setGameState(GameState.GAME_OVER);\r\n        return currentBoard;\r\n      }\r\n\r\n      const randomCol = availableColumns[Math.floor(Math.random() * availableColumns.length)];\r\n      const row = getLowestEmptyRow(currentBoard, randomCol);\r\n      \r\n      if (row === -1) {\r\n        setGameState(GameState.GAME_OVER);\r\n        return currentBoard;\r\n      }\r\n\r\n      const ball = generateRandomBall({ row, col: randomCol });\r\n      const newBoard = [...currentBoard];\r\n      newBoard[row][randomCol] = ball;\r\n\r\n      return newBoard;\r\n    });\r\n  }, []);\r\n\r\n  // 處理連鎖反應\r\n  const processMatches = useCallback((currentBoard: (Ball | null)[][]) => {\r\n    let newBoard = [...currentBoard.map(row => [...row])];\r\n    let totalMatches = 0;\r\n    let comboCount = 0;\r\n\r\n    const processRound = () => {\r\n      const matches = findAllMatches(newBoard);\r\n      \r\n      if (matches.length === 0) {\r\n        // 沒有更多匹配，結束連鎖\r\n        if (totalMatches > 0) {\r\n          const scoreGain = calculateScore(totalMatches, comboCount);\r\n          setStats(prev => {\r\n            const newScore = prev.score + scoreGain;\r\n            const newStats = {\r\n              ...prev,\r\n              score: newScore,\r\n              linesCleared: prev.linesCleared + Math.floor(totalMatches / currentLevelConfig.minMatchCount),\r\n              combo: comboCount,\r\n              level: Math.floor(newScore / 1000) + 1\r\n            };\r\n            \r\n            // 檢查是否完成當前關卡\r\n            if (newScore >= currentLevelConfig.targetScore && !levelComplete) {\r\n              setTimeout(() => setLevelComplete(true), 1000);\r\n            }\r\n            \r\n            return newStats;\r\n          });\r\n\r\n          // 重置連擊計數器\r\n          setTimeout(() => {\r\n            setStats(prev => ({ ...prev, combo: 0 }));\r\n          }, 2000);\r\n        }\r\n        return;\r\n      }\r\n\r\n      // 移除匹配的球\r\n      newBoard = removeBalls(newBoard, matches);\r\n      totalMatches += matches.length;\r\n      comboCount++;\r\n\r\n      // 等待爆炸動畫完成後應用重力\r\n      setTimeout(() => {\r\n        // 實際移除球\r\n        matches.forEach(pos => {\r\n          newBoard[pos.row][pos.col] = null;\r\n        });\r\n        \r\n        // 應用重力\r\n        newBoard = applyGravity(newBoard);\r\n        setBoard(newBoard);\r\n        \r\n        // 繼續處理下一輪匹配\r\n        setTimeout(() => processRound(), 600);\r\n      }, 400);\r\n    };\r\n\r\n    processRound();\r\n  }, [currentLevelConfig.minMatchCount, currentLevelConfig.targetScore, levelComplete]);\r\n\r\n  // 開始遊戲\r\n  const startGame = useCallback((difficulty?: Difficulty) => {\r\n    if (difficulty) {\r\n      setCurrentDifficulty(difficulty);\r\n    }\r\n    setGameState(GameState.PLAYING);\r\n    setBoard(createEmptyBoard());\r\n    setStats({\r\n      score: 0,\r\n      level: 1,\r\n      linesCleared: 0,\r\n      combo: 0,\r\n      timeElapsed: 0\r\n    });\r\n    setLevelComplete(false);\r\n    initializeNextBall();\r\n\r\n    // 開始時間計時器\r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n    timeTimerRef.current = setInterval(() => {\r\n      setStats(prev => ({ ...prev, timeElapsed: prev.timeElapsed + 1 }));\r\n    }, 1000);\r\n\r\n    const levelConfig = difficulty ? LEVEL_CONFIGS[difficulty] : currentLevelConfig;\r\n\r\n    // 開始自動掉落計時器\r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    dropTimerRef.current = setInterval(() => {\r\n      dropRandomBall();\r\n    }, levelConfig.dropInterval);\r\n  }, [initializeNextBall, dropRandomBall, currentLevelConfig]);\r\n\r\n  // 暫停遊戲\r\n  const pauseGame = useCallback(() => {\r\n    setGameState(GameState.PAUSED);\r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n  }, []);\r\n\r\n  // 恢復遊戲\r\n  const resumeGame = useCallback(() => {\r\n    setGameState(GameState.PLAYING);\r\n    \r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n    timeTimerRef.current = setInterval(() => {\r\n      setStats(prev => ({ ...prev, timeElapsed: prev.timeElapsed + 1 }));\r\n    }, 1000);\r\n\r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    dropTimerRef.current = setInterval(() => {\r\n      dropRandomBall();\r\n    }, GAME_CONFIG.DROP_INTERVAL);\r\n  }, [dropRandomBall]);\r\n\r\n  // 結束遊戲\r\n  const endGame = useCallback(() => {\r\n    setGameState(GameState.GAME_OVER);\r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\r\n    \r\n    // 檢查最高分\r\n    checkAndUpdateHighScore(stats.score, stats.level);\r\n  }, [checkAndUpdateHighScore, stats.score, stats.level]);\r\n\r\n  // 點擊格子放置球\r\n  const handleCellClick = useCallback((row: number, col: number) => {\r\n    if (gameState !== GameState.PLAYING || !nextBall) return;\r\n\r\n    const targetRow = getLowestEmptyRow(board, col);\r\n    if (targetRow === -1) return; // 該列已滿\r\n\r\n    // 放置球\r\n    const newBoard = [...board];\r\n    const ballToPlace = { ...nextBall, position: { row: targetRow, col } };\r\n    newBoard[targetRow][col] = ballToPlace;\r\n    \r\n    setBoard(newBoard);\r\n    \r\n    // 生成下一個球\r\n    initializeNextBall();\r\n    \r\n    // 檢查匹配\r\n    setTimeout(() => {\r\n      processMatches(newBoard);\r\n    }, 100);\r\n\r\n    // 檢查遊戲結束\r\n    if (isGameOver(newBoard)) {\r\n      endGame();\r\n    }\r\n  }, [gameState, nextBall, board, processMatches, initializeNextBall, endGame]);\r\n\r\n  // 重置遊戲\r\n  const resetGame = useCallback(() => {\r\n    setGameState(GameState.MENU);\r\n    setBoard(createEmptyBoard());\r\n    setStats({\r\n      score: 0,\r\n      level: 1,\r\n      linesCleared: 0,\r\n      combo: 0,\r\n      timeElapsed: 0\r\n    });\r\n    setNextBall(null);\r\n    \r\n    if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n    if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n    if (gameLoopRef.current) clearInterval(gameLoopRef.current);\r\n  }, []);\r\n\r\n  // 清理計時器\r\n  useEffect(() => {\r\n    return () => {\r\n      if (dropTimerRef.current) clearInterval(dropTimerRef.current);\r\n      if (timeTimerRef.current) clearInterval(timeTimerRef.current);\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\r\n    };\r\n  }, []);\r\n\r\n  // 進入下一關\r\n  const nextLevelHandler = useCallback(() => {\r\n    const next = getNextLevel(currentDifficulty);\r\n    if (next) {\r\n      setCurrentDifficulty(next.id);\r\n      startGame(next.id);\r\n      setLevelComplete(false);\r\n    }\r\n  }, [currentDifficulty, startGame]);\r\n\r\n  // 設置難度\r\n  const setDifficultyHandler = useCallback((difficulty: Difficulty) => {\r\n    setCurrentDifficulty(difficulty);\r\n  }, []);\r\n\r\n  return {\r\n    gameState,\r\n    board,\r\n    nextBall,\r\n    stats,\r\n    highScore,\r\n    isNewHighScore,\r\n    currentDifficulty,\r\n    currentLevelConfig,\r\n    levelComplete,\r\n    startGame,\r\n    pauseGame,\r\n    resumeGame,\r\n    resetGame,\r\n    nextLevel: nextLevelHandler,\r\n    setDifficulty: setDifficultyHandler,\r\n    handleCellClick\r\n  };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}